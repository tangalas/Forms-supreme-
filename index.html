<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SeeMe Rolling E-Bike Rental Agreement</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <!-- PDF Generation Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <!-- Signature Pad Library -->
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
  <!-- Date Picker Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pikaday/1.8.2/pikaday.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pikaday/1.8.2/css/pikaday.min.css">
  <!-- EmailJS for sending emails -->
  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
  <!-- Google API Client for Google Drive integration -->
  <script src="https://apis.google.com/js/api.js"></script>
  <script src="https://accounts.google.com/gsi/client"></script>
  <style>
    :root {
      --color-emerald-100: #d1fae5;
      --color-emerald-500: #10b981;
      --color-emerald-600: #059669;
      --color-emerald-700: #047857;
      --color-emerald-800: #065f46;
      --color-purple-900: #4c1d95;
      --color-indigo-700: #4338ca;
      --color-indigo-800: #3730a3;
    }
    
    body {
      font-family: 'Inter', sans-serif;
    }
    
    .bg-emerald-500 {
      background-color: var(--color-emerald-500);
    }
    
    .bg-emerald-100 {
      background-color: var(--color-emerald-100);
    }
    
    .bg-emerald-600 {
      background-color: var(--color-emerald-600);
    }
    
    .text-emerald-800 {
      color: var(--color-emerald-800);
    }
    
    .text-emerald-700 {
      color: var(--color-emerald-700);
    }
    
    .text-purple-900 {
      color: var(--color-purple-900);
    }
    
    .bg-indigo-700 {
      background-color: var(--color-indigo-700);
    }
    
    .hover\:bg-indigo-800:hover {
      background-color: var(--color-indigo-800);
    }
    
    .signature-pad {
      width: 100%;
      height: 150px;
      background-color: white;
      border: 1px solid #ccc;
      border-radius: 0.5rem;
    }
    
    .dropdown {
      position: relative;
      display: inline-block;
    }
    
    .dropdown-content {
      display: none;
      position: absolute;
      right: 0;
      background-color: white;
      min-width: 200px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 1;
      border-radius: 0.5rem;
      max-height: 300px;
      overflow-y: auto;
    }
    
    .dropdown-content.show {
      display: block;
    }
    
    .dropdown-item {
      color: black;
      padding: 12px 16px;
      text-decoration: none;
      display: flex;
      align-items: center;
      cursor: pointer;
    }
    
    .dropdown-item:hover {
      background-color: #f1f1f1;
    }
    
    .accessory-btn {
      width: 3rem;
      height: 3rem;
      border-radius: 9999px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.125rem;
      font-weight: 500;
      margin-right: 0.5rem;
      background-color: white;
      color: var(--color-emerald-800);
      cursor: pointer;
    }
    
    .accessory-btn.selected {
      background-color: var(--color-emerald-600);
      color: white;
    }
    
    .upload-container {
      border: 2px dashed #ccc;
      border-radius: 0.5rem;
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background-color: white;
      cursor: pointer;
      position: relative;
    }
    
    .preview-container {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.5rem;
      width: 100%;
    }
    
    @media (min-width: 768px) {
      .preview-container {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    
    .preview-image {
      position: relative;
      height: 6rem;
    }
    
    .preview-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 0.25rem;
    }
    
    .remove-btn {
      position: absolute;
      top: 0.25rem;
      right: 0.25rem;
      background-color: #ef4444;
      color: white;
      border-radius: 9999px;
      width: 1.5rem;
      height: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    
    /* Time picker styles */
    .time-picker-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      width: 100%;
      background-color: white;
      border-radius: 0.5rem;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 10;
      padding: 1rem;
    }
    
    .time-select {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0.5rem;
      margin-top: 0.5rem;
    }
    
    select {
      width: 100%;
      padding: 0.5rem;
      border-radius: 0.25rem;
      border: 1px solid #ccc;
    }
    
    /* Loading overlay */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      color: white;
    }
    
    .spinner {
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top: 4px solid white;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin-bottom: 1rem;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body class="min-h-screen bg-emerald-500">
  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay" style="display: none;">
    <div class="spinner"></div>
    <p id="loadingText">Processing your submission...</p>
  </div>

  <main class="flex flex-col items-center py-8 px-4">
    <div class="w-full max-w-3xl">
      <!-- Language Selector -->
      <div class="flex justify-end mb-4">
        <div class="dropdown">
          <button id="languageBtn" class="flex items-center gap-2 text-white bg-emerald-600/30 rounded-md px-3 py-1.5">
            <span id="selectedLanguage">üá∫üá∏ English (US)</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
          </button>
          <div id="languageDropdown" class="dropdown-content">
            <div class="dropdown-item" data-lang="en-US">
              <span>üá∫üá∏ English (US)</span>
              <svg class="ml-auto h-4 w-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
            </div>
            <div class="dropdown-item" data-lang="el-GR">
              <span>üá¨üá∑ ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨</span>
            </div>
            <div class="dropdown-item" data-lang="de-DE">
              <span>üá©üá™ Deutsch</span>
            </div>
            <div class="dropdown-item" data-lang="fr-FR">
              <span>üá´üá∑ Fran√ßais</span>
            </div>
            <div class="dropdown-item" data-lang="it-IT">
              <span>üáÆüáπ Italiano</span>
            </div>
            <div class="dropdown-item" data-lang="es-ES">
              <span>üá™üá∏ Espa√±ol</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Logo -->
      <div class="flex justify-center mb-4">
        <div class="bg-emerald-100 rounded-lg p-4 w-40 h-40 flex items-center justify-center">
          <img src="logo.png" alt="SeeMe Rolling Logo" class="rounded-full w-full h-full object-contain" />
        </div>
      </div>
      
      <!-- Title -->
      <h1 id="formTitle" class="text-2xl md:text-3xl font-bold text-center text-purple-900 mb-8">
        SeeMe Rolling E-Bike Rental Agreement
      </h1>
      
      <!-- Rental Form -->
      <form id="rentalForm" class="space-y-8">
        <!-- Renter Information -->
        <div class="bg-emerald-100/80 rounded-lg p-6">
          <h2 id="renterInfoTitle" class="text-lg font-semibold mb-4 text-emerald-800">Renter Information</h2>
          
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
            <div class="space-y-2">
              <label for="firstName" class="text-sm block">
                <span id="firstNameLabel">First Name</span> <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="firstName"
                name="firstName"
                placeholder="First Name"
                class="w-full px-3 py-2 border border-gray-300 rounded-md bg-white"
              />
              <p id="firstNameError" class="text-xs text-red-500 hidden"></p>
            </div>
            
            <div class="space-y-2">
              <label for="middleName" class="text-sm block">
                <span id="middleNameLabel">Middle Name</span>
              </label>
              <input
                type="text"
                id="middleName"
                name="middleName"
                placeholder="Middle Name"
                class="w-full px-3 py-2 border border-gray-300 rounded-md bg-white"
              />
            </div>
            
            <div class="space-y-2">
              <label for="lastName" class="text-sm block">
                <span id="lastNameLabel">Last Name</span> <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="lastName"
                name="lastName"
                placeholder="Last Name"
                class="w-full px-3 py-2 border border-gray-300 rounded-md bg-white"
              />
              <p id="lastNameError" class="text-xs text-red-500 hidden"></p>
            </div>
          </div>
          
          <div class="space-y-2 mb-4">
            <label for="nationality" class="text-sm block">
              <span id="nationalityLabel">Nationality</span> <span class="text-red-500">*</span>
            </label>
            <input
              type="text"
              id="nationality"
              name="nationality"
              placeholder="Nationality"
              class="w-full px-3 py-2 border border-gray-300 rounded-md bg-white"
            />
            <p id="nationalityError" class="text-xs text-red-500 hidden"></p>
          </div>
          
          <div class="space-y-2 mb-4">
            <label for="email" class="text-sm block">
              <span id="emailLabel">Email</span> <span class="text-red-500">*</span>
            </label>
            <input
              type="email"
              id="email"
              name="email"
              placeholder="example@example.com"
              class="w-full px-3 py-2 border border-gray-300 rounded-md bg-white"
            />
            <p id="emailError" class="text-xs text-red-500 hidden"></p>
          </div>
          
          <div class="space-y-2 mb-4">
            <label for="phoneNumber" class="text-sm block">
              <span id="phoneNumberLabel">Phone Number</span> <span class="text-red-500">*</span>
            </label>
            <div class="grid grid-cols-3 md:grid-cols-4 gap-2">
              <div>
                <div class="dropdown">
                  <button type="button" id="countryCodeBtn" class="w-full flex justify-between items-center px-3 py-2 border border-gray-300 rounded-md bg-white">
                    <span id="selectedCountryCode">+1</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                  </button>
                  <div id="countryCodeDropdown" class="dropdown-content">
                    <input type="text" id="countryCodeSearch" placeholder="Search country code..." class="w-full px-3 py-2 border-b border-gray-300">
                    <div id="countryCodeList" class="overflow-y-auto max-h-60">
                      <!-- Country codes will be populated by JavaScript -->
                    </div>
                  </div>
                </div>
                <p class="text-xs mt-1 text-emerald-700" id="countryCodeText">Country Code</p>
              </div>
              <div class="col-span-2 md:col-span-3">
                <input
                  type="text"
                  id="phoneNumber"
                  name="phoneNumber"
                  placeholder="Phone Number"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md bg-white"
                />
                <p class="text-xs mt-1 text-emerald-700" id="phoneNumberText">Phone Number</p>
              </div>
            </div>
            <p id="phoneNumberError" class="text-xs text-red-500 hidden"></p>
          </div>
          
          <div class="space-y-2 mb-4">
            <label class="text-sm block">
              <span id="vehicleTypeLabel">Type of Vehicle</span> <span class="text-red-500">*</span>
            </label>
            <div id="vehicleTypeContainer" class="space-y-2">
              <div class="flex items-center space-x-2">
                <input type="radio" id="eScooter" name="vehicleType" value="eScooter" class="h-4 w-4">
                <label for="eScooter" class="text-sm font-medium" id="eScooterLabel">E- Scooter</label>
              </div>
              
              <div class="flex items-center space-x-2">
                <input type="radio" id="mountainEBike" name="vehicleType" value="mountainEBike" class="h-4 w-4">
                <label for="mountainEBike" class="text-sm font-medium" id="mountainEBikeLabel">Mountain E- Bike</label>
              </div>
              
              <div class="flex items-center space-x-2">
                <input type="radio" id="trekkingEBike" name="vehicleType" value="trekkingEBike" class="h-4 w-4">
                <label for="trekkingEBike" class="text-sm font-medium" id="trekkingEBikeLabel">Trekking E-bike</label>
              </div>
              
              <div class="flex items-center space-x-2">
                <input type="radio" id="fatTireEBike" name="vehicleType" value="fatTireEBike" class="h-4 w-4">
                <label for="fatTireEBike" class="text-sm font-medium" id="fatTireEBikeLabel">Fat Tire E-bike</label>
              </div>
            </div>
            <p id="vehicleTypeError" class="text-xs text-red-500 hidden"></p>
          </div>
          
          <div class="space-y-2 mb-4">
            <label for="idDocument" class="text-sm block">
              <span id="idDocumentLabel">Passport/ID / DRIVER'S LICENSE</span> <span class="text-red-500">*</span>
            </label>
            <div 
              id="idDocumentUpload"
              class="upload-container"
              onclick="document.getElementById('idDocument').click()"
            >
              <div id="idDocumentPreview" class="hidden relative w-full">
                <img
                  id="idDocumentImage" 
                  src="/placeholder.svg" 
                  alt="ID Document" 
                  class="max-h-40 mx-auto object-contain"
                />
                <button
                  type="button"
                  id="removeIdDocument"
                  class="absolute top-0 right-0 bg-red-500 text-white rounded-full p-1"
                  onclick="event.stopPropagation(); clearIdDocument()"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
              </div>
              <div id="idDocumentPlaceholder">
                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                <p class="text-sm text-gray-500 font-medium" id="browseFilesText">Browse Files</p>
                <p class="text-xs text-gray-400" id="dragAndDropText">Drag and drop files here</p>
              </div>
              <input
                type="file"
                id="idDocument"
                class="hidden"
                accept="image/*,.pdf"
              />
            </div>
            <p id="idDocumentError" class="text-xs text-red-500 hidden"></p>
          </div>
        </div>
        
        <!-- Rental Period -->
        <div class="bg-emerald-100/80 rounded-lg p-6">
          <h2 id="rentalPeriodTitle" class="text-lg font-semibold mb-4 text-emerald-800">Rental Period</h2>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-4">
            <div class="space-y-2">
              <label class="text-sm block">
                <span id="fromLabel">From</span> <span class="text-red-500">*</span>
              </label>
              <div class="grid grid-cols-1 gap-2">
                <div>
                  <button
                    type="button"
                    id="fromDateBtn"
                    class="w-full flex justify-start items-center px-3 py-2 border border-gray-300 rounded-md bg-white text-left"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                    <span id="fromDateText">Select date</span>
                  </button>
                  <div id="fromDatePicker" class="hidden"></div>
                  <p class="text-xs mt-1 text-emerald-700" id="dateText">Date</p>
                  <p id="fromDateError" class="text-xs text-red-500 hidden"></p>
                </div>
                
                <div>
                  <button
                    type="button"
                    id="fromTimeBtn"
                    class="w-full flex justify-start items-center px-3 py-2 border border-gray-300 rounded-md bg-white text-left"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                    <span id="fromTimeText">Select time</span>
                  </button>
                  <div id="fromTimePicker" class="time-picker-dropdown hidden">
                    <div class="flex items-center gap-2">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                      <label id="selectTimeLabel">Select time</label>
                    </div>
                    <div class="time-select">
                      <div>
                        <select id="fromTimeHour">
                          <option value="01">01</option>
                          <option value="02">02</option>
                          <option value="03">03</option>
                          <option value="04">04</option>
                          <option value="05">05</option>
                          <option value="06">06</option>
                          <option value="07">07</option>
                          <option value="08">08</option>
                          <option value="09">09</option>
                          <option value="10">10</option>
                          <option value="11">11</option>
                          <option value="12" selected>12</option>
                        </select>
                      </div>
                      <div>
                        <select id="fromTimeMinute">
                          <option value="00" selected>00</option>
                          <option value="05">05</option>
                          <option value="10">10</option>
                          <option value="15">15</option>
                          <option value="20">20</option>
                          <option value="25">25</option>
                          <option value="30">30</option>
                          <option value="35">35</option>
                          <option value="40">40</option>
                          <option value="45">45</option>
                          <option value="50">50</option>
                          <option value="55">55</option>
                        </select>
                      </div>
                      <div>
                        <select id="fromTimePeriod">
                          <option value="AM">AM</option>
                          <option value="PM" selected>PM</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <p class="text-xs mt-1 text-emerald-700" id="hourMinutesText">Hour Minutes</p>
                  <p id="fromTimeError" class="text-xs text-red-500 hidden"></p>
                </div>
              </div>
            </div>
            
            <div class="space-y-2">
              <label class="text-sm block">
                <span id="untilLabel">Until</span> <span class="text-red-500">*</span>
              </label>
              <div class="grid grid-cols-1 gap-2">
                <div>
                  <button
                    type="button"
                    id="untilDateBtn"
                    class="w-full flex justify-start items-center px-3 py-2 border border-gray-300 rounded-md bg-white text-left"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                    <span id="untilDateText">Select date</span>
                  </button>
                  <div id="untilDatePicker" class="hidden"></div>
                  <p class="text-xs mt-1 text-emerald-700">Date</p>
                  <p id="untilDateError" class="text-xs text-red-500 hidden"></p>
                </div>
                
                <div>
                  <button
                    type="button"
                    id="untilTimeBtn"
                    class="w-full flex justify-start items-center px-3 py-2 border border-gray-300 rounded-md bg-white text-left"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                    <span id="untilTimeText">Select time</span>
                  </button>
                  <div id="untilTimePicker" class="time-picker-dropdown hidden">
                    <div class="flex items-center gap-2">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                      <label>Select time</label>
                    </div>
                    <div class="time-select">
                      <div>
                        <select id="untilTimeHour">
                          <option value="01">01</option>
                          <option value="02">02</option>
                          <option value="03">03</option>
                          <option value="04">04</option>
                          <option value="05">05</option>
                          <option value="06">06</option>
                          <option value="07">07</option>
                          <option value="08">08</option>
                          <option value="09">09</option>
                          <option value="10">10</option>
                          <option value="11">11</option>
                          <option value="12" selected>12</option>
                        </select>
                      </div>
                      <div>
                        <select id="untilTimeMinute">
                          <option value="00" selected>00</option>
                          <option value="05">05</option>
                          <option value="10">10</option>
                          <option value="15">15</option>
                          <option value="20">20</option>
                          <option value="25">25</option>
                          <option value="30">30</option>
                          <option value="35">35</option>
                          <option value="40">40</option>
                          <option value="45">45</option>
                          <option value="50">50</option>
                          <option value="55">55</option>
                        </select>
                      </div>
                      <div>
                        <select id="untilTimePeriod">
                          <option value="AM">AM</option>
                          <option value="PM" selected>PM</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <p class="text-xs mt-1 text-emerald-700">Hour Minutes</p>
                  <p id="untilTimeError" class="text-xs text-red-500 hidden"></p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="space-y-2 mb-4">
            <label class="text-sm block">
              <span id="vehicleConditionLabel">Vehicle Condition Before Rental</span> <span class="text-red-500">*</span>
            </label>
            <div 
              id="vehicleConditionUpload"
              class="upload-container"
              onclick="document.getElementById('vehicleCondition').click()"
            >
              <div id="vehicleConditionPreviewContainer" class="hidden w-full">
                <div id="vehicleConditionPreview" class="preview-container">
                  <!-- Images will be added here -->
                </div>
                <p class="text-xs text-center mt-2 text-gray-500" id="addMoreImagesText">Click to add more images</p>
              </div>
              <div id="vehicleConditionPlaceholder">
                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                <p class="text-sm text-gray-500 font-medium" id="browseFilesTextMultiple">Browse Files</p>
                <p class="text-xs text-gray-400" id="dragAndDropTextMultiple">Drag and drop multiple images here</p>
              </div>
              <input
                type="file"
                id="vehicleCondition"
                class="hidden"
                accept="image/*"
                multiple
              />
            </div>
            <p id="vehicleConditionError" class="text-xs text-red-500 hidden"></p>
          </div>
        </div>
        
        <!-- Accessories -->
        <div class="bg-emerald-100/80 rounded-lg p-6">
          <h2 id="accessoriesTitle" class="text-lg font-semibold mb-4 text-emerald-800">Accessories</h2>
          
          <div class="space-y-6">
            <div>
              <label class="text-sm mb-2 block" id="helmetLabel">Helmet</label>
              <div class="flex flex-wrap">
                <button type="button" class="accessory-btn selected" data-type="helmet" data-value="0">0</button>
                <button type="button" class="accessory-btn" data-type="helmet" data-value="1">1</button>
                <button type="button" class="accessory-btn" data-type="helmet" data-value="2">2</button>
                <button type="button" class="accessory-btn" data-type="helmet" data-value="3">3</button>
                <button type="button" class="accessory-btn" data-type="helmet" data-value="4">4</button>
                <button type="button" class="accessory-btn" data-type="helmet" data-value="5">5</button>
              </div>
            </div>
            
            <div>
              <label class="text-sm mb-2 block" id="lockLabel">Lock</label>
              <div class="flex flex-wrap">
                <button type="button" class="accessory-btn selected" data-type="lock" data-value="0">0</button>
                <button type="button" class="accessory-btn" data-type="lock" data-value="1">1</button>
                <button type="button" class="accessory-btn" data-type="lock" data-value="2">2</button>
                <button type="button" class="accessory-btn" data-type="lock" data-value="3">3</button>
                <button type="button" class="accessory-btn" data-type="lock" data-value="4">4</button>
                <button type="button" class="accessory-btn" data-type="lock" data-value="5">5</button>
              </div>
            </div>
            
            <div>
              <label class="text-sm mb-2 block" id="elasticStrapsLabel">Elastic Straps</label>
              <div class="flex flex-wrap">
                <button type="button" class="accessory-btn selected" data-type="elasticStraps" data-value="0">0</button>
                <button type="button" class="accessory-btn" data-type="elasticStraps" data-value="1">1</button>
                <button type="button" class="accessory-btn" data-type="elasticStraps" data-value="2">2</button>
                <button type="button" class="accessory-btn" data-type="elasticStraps" data-value="3">3</button>
                <button type="button" class="accessory-btn" data-type="elasticStraps" data-value="4">4</button>
                <button type="button" class="accessory-btn" data-type="elasticStraps" data-value="5">5</button>
              </div>
            </div>
            
            <div>
              <label class="text-sm mb-2 block" id="otherAccessoriesLabel">Other Accessories</label>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <div class="flex items-center space-x-2">
                  <input type="checkbox" id="bikeMirror" class="h-4 w-4">
                  <label for="bikeMirror" class="text-sm font-medium" id="bikeMirrorLabel">Bike Mirror</label>
                </div>
                
                <div class="flex items-center space-x-2">
                  <input type="checkbox" id="phoneMount" class="h-4 w-4">
                  <label for="phoneMount" class="text-sm font-medium" id="phoneMountLabel">Phone Mount</label>
                </div>
                
                <div class="flex items-center space-x-2">
                  <input type="checkbox" id="charger" class="h-4 w-4">
                  <label for="charger" class="text-sm font-medium" id="chargerLabel">Charger</label>
                </div>
                
                <div class="flex items-center space-x-2">
                  <input type="checkbox" id="batteryKey" class="h-4 w-4">
                  <label for="batteryKey" class="text-sm font-medium" id="batteryKeyLabel">Battery Key</label>
                </div>
                
                <div class="flex items-center space-x-2">
                  <input type="checkbox" id="babySeat" class="h-4 w-4">
                  <label for="babySeat" class="text-sm font-medium" id="babySeatLabel">Baby Seat</label>
                </div>
                
                <div class="flex items-center space-x-2">
                  <input type="checkbox" id="bikeBasket" class="h-4 w-4">
                  <label for="bikeBasket" class="text-sm font-medium" id="bikeBasketLabel">Bike Basket</label>
                </div>
                
                <div class="flex items-center space-x-2">
                  <input type="checkbox" id="seatCushion" class="h-4 w-4">
                  <label for="seatCushion" class="text-sm font-medium" id="seatCushionLabel">Seat Cushion</label>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Terms and Conditions -->
        <div class="bg-emerald-100/80 rounded-lg p-6">
          <h2 id="termsTitle" class="text-lg font-semibold mb-4 text-emerald-800 text-center">TERMS AND CONDITIONS OF VEHICLE RENTAL</h2>
          
          <div class="bg-white/80 rounded-lg p-4 mb-4 max-h-60 overflow-y-auto">
            <p class="text-sm" id="termsText">
              - Only the person(s) referred to in the agreement will be permitted to drive the vehicle(s).In case any vehicle is to be used by an underaged, specifically (15-17) years old for the e-bikes or (12-17) for the scooters, then this contract is the written consent of the parent/legal guardian. More on the corresponding section below.*<br /><br />
              -The renter is responsible for any breaking of traffic laws: wrong parking, fast driving etc.<br /><br />
              - It is strictly forbidden to ride any bicycle/scouter off-road, to ride any bicycle/scouter on the beach and to ride any bicycle/scouter with more than one person at the same time.<br /><br />
              - The renter will return the vehicle concerned with all tools, accessories and equipment to the store in the city where the vehicle was rented or as otherwise specified on the undersigned page of the agreement. Prolongation of rental period is under the owner's approval and without it the renter will be charged accordingly.<br /><br />
              - The renter is obliged to return the vehicle batteries fully charged, if the rental period is at least a day. Otherwise there will be an additional charge of 5 euros for each battery.<br /><br />
              - The owner reserves the right to repossess the vehicle at any time without demand, at customer's expense, if the vehicle is used in violation of this agreement.<br /><br />
              - The renter who wishes to remove the vehicle from the island of Symi, has to have written consent from the owner.<br /><br />
              -Each vehicle that is rented for 5+ hours must be returned at 11:00 AM of the day that the renting period ends.<br /><br />
              
              <strong>Vehicle condition/Maintenance Responsibility</strong><br /><br />
              
              - The renter confirms hereby that before taking delivery of the vehicle he has examined it and found it without any damages, except of those shown on the remarks (1st page).<br /><br />
              - The renter confirms that he received demonstration/instructions of the proper use of the vehicle. This demonstration covers all aspects of safe vehicle operation, the renter's maintenance responsibilities, local and state laws. Also the renter was offered a safety helmet and it is the renter's own choice if the renter did not accept it.<br /><br />
              - The renter agrees to take care of the vehicle, and holds responsibility for checking the vehicle's health and reporting mechanical failures immediately, even when it is not in use. Renter may be held responsible for mechanical damage due to negligence in vehicle operation or failure to provide normal maintenance.<br /><br />
              - In case of breakdown or mechanical damage the customer is responsible for transporting the vehicle back to the store. If it is not possible then the store should be informed of the exact location and will arrange a collection for which the customer is obliged to pay. The customer will also be charged for any damage made to the vehicle(s).<br /><br />
              - All bicycles/scooters can be locked, you may ask at the shop station for an extra lock or chain for additional security, our insurance does not cover theft, and so in such a case the renter will be charged for the vehicle or parts of it being stolen.<br /><br />
              
              -The terms are governed by and interpreted in accordance with Greek law. In case of any disagreement between the contracted parties the Greek courts only will do justice.<br /><br />
              
              -With this contract the store rents to the undersigned renter the vehicle described on the first page of this agreement, terms and conditions have been read and accepted by the signed renter.
            </p>
          </div>
          
          <div class="flex items-center space-x-2 mb-4">
            <input type="checkbox" id="termsAgreed" class="h-4 w-4">
            <label for="termsAgreed" class="text-sm font-medium">
              <span id="readAndAgreed">I have read and agreed to the</span> <a href="#" class="text-blue-600 underline" id="termsAndConditionsLink">terms & conditions</a> <span class="text-red-500">*</span>
            </label>
          </div>
          <p id="termsAgreedError" class="text-xs text-red-500 hidden"></p>
          
          <div class="space-y-2 mb-4">
            <label class="text-sm" id="underagedQuestionLabel">Is there any underaged person participating?</label>
            <div class="flex space-x-4">
              <div class="flex items-center space-x-2">
                <input type="radio" id="underagedYes" name="underagedPerson" value="yes" class="h-4 w-4">
                <label for="underagedYes" class="text-sm" id="yesLabel">Yes</label>
              </div>
              <div class="flex items-center space-x-2">
                <input type="radio" id="underagedNo" name="underagedPerson" value="no" class="h-4 w-4" checked>
                <label for="underagedNo" class="text-sm" id="noLabel">No</label>
              </div>
            </div>
          </div>
          
          <div class="space-y-2 mb-4">
            <label class="text-sm" id="ownerSignatureLabel">Owner's signature:</label>
            <div class="border border-gray-300 rounded-lg bg-white p-2 flex justify-center">
              <img src="owner-signature.png" alt="Owner's signature" class="h-[100px] object-contain">
            </div>
          </div>
          
          <div class="space-y-2 mb-4">
            <label class="text-sm">
              <span id="participantSignatureLabel">Participant's signature</span> <span class="text-red-500">*</span>
            </label>
            <div class="border border-gray-300 rounded-lg bg-white">
              <canvas id="signatureCanvas" class="w-full h-[150px]"></canvas>
            </div>
            <div class="flex justify-end">
              <button type="button" id="clearSignatureBtn" class="px-3 py-1 border border-gray-300 rounded-md bg-white text-sm">
                <span id="clearLabel">Clear</span>
              </button>
            </div>
            <p id="participantSignatureError" class="text-xs text-red-500 hidden"></p>
          </div>
        </div>
        
        <div class="flex justify-end">
          <button 
            type="submit" 
            id="submitBtn"
            class="bg-indigo-700 hover:bg-indigo-800 text-white px-8 py-2 text-lg rounded-md"
          >
            <span id="submitLabel">Submit</span>
          </button>
        </div>
      </form>
    </div>
  </main>
  
  <!-- JavaScript for form functionality -->
  <script>
    // Translations object
    const translations = {
      'en-US': {
        formTitle: 'SeeMe Rolling E-Bike Rental Agreement',
        renterInfo: 'Renter Information',
        rentalPeriod: 'Rental Period',
        accessories: 'Accessories',
        termsTitle: 'TERMS AND CONDITIONS OF VEHICLE RENTAL',
        vehicleCondition: 'Vehicle Condition Before Rental',
        firstName: 'First Name',
        middleName: 'Middle Name',
        lastName: 'Last Name',
        nationality: 'Nationality',
        email: 'Email',
        phoneNumber: 'Phone Number',
        countryCode: 'Country Code',
        vehicleType: 'Type of Vehicle',
        idDocument: 'Passport/ID / DRIVER\'S LICENSE',
        eScooter: 'E- Scooter',
        mountainEBike: 'Mountain E- Bike',
        trekkingEBike: 'Trekking E-bike',
        fatTireEBike: 'Fat Tire E-bike',
        from: 'From',
        until: 'Until',
        date: 'Date',
        hourMinutes: 'Hour Minutes',
        selectDate: 'Select date',
        selectTime: 'Select time',
        helmet: 'Helmet',
        lock: 'Lock',
        elasticStraps: 'Elastic Straps',
        otherAccessories: 'Other Accessories',
        bikeMirror: 'Bike Mirror',
        phoneMount: 'Phone Mount',
        charger: 'Charger',
        batteryKey: 'Battery Key',
        babySeat: 'Baby Seat',
        bikeBasket: 'Bike Basket',
        seatCushion: 'Seat Cushion',
        browseFiles: 'Browse Files',
        dragAndDrop: 'Drag and drop files here',
        dragAndDropMultiple: 'Drag and drop multiple images here',
        addMoreImages: 'Click to add more images',
        readAndAgreed: 'I have read and agreed to the',
        termsAndConditions: 'terms & conditions',
        underagedQuestion: 'Is there any underaged person participating?',
        yes: 'Yes',
        no: 'No',
        ownerSignature: 'Owner\'s signature:',
        participantSignature: 'Participant\'s signature',
        signHere: 'Sign Here',
        clear: 'Clear',
        submit: 'Submit',
        submitting: 'Submitting...',
        required: 'is required',
        selectVehicleType: 'Please select a vehicle type',
        uploadId: 'ID document is required',
        uploadVehicleImages: 'Please upload vehicle condition images',
        agreeToTerms: 'You must agree to the terms and conditions',
        signatureRequired: 'Participant signature is required',
        processingSubmission: 'Processing your submission...',
        emailSent: 'Email sent successfully!',
        uploadingToDrive: 'Uploading to Google Drive...',
        uploadComplete: 'Upload complete!',
        submissionSuccess: 'Form submitted successfully! A copy has been sent to your email and saved to Google Drive.'
      },
      'el-GR': {
        formTitle: 'SeeMe Rolling Œ£œÖŒºœÜœâŒΩŒ∑œÑŒπŒ∫œå ŒïŒΩŒøŒπŒ∫ŒØŒ±œÉŒ∑œÇ E-Bike',
        renterInfo: 'Œ£œÑŒøŒπœáŒµŒØŒ± ŒïŒΩŒøŒπŒ∫ŒπŒ±œÉœÑŒÆ',
        rentalPeriod: 'Œ†ŒµœÅŒØŒøŒ¥ŒøœÇ ŒïŒΩŒøŒπŒ∫ŒØŒ±œÉŒ∑œÇ',
        // Additional Greek translations would go here
      },
      // Additional languages would go here
    };
    
    let currentLanguage = 'en-US';
    let formData = {
      firstName: "",
      middleName: "",
      lastName: "",
      nationality: "",
      email: "",
      countryCode: "+1",
      phoneNumber: "",
      vehicleType: "",
      idDocument: null,
      idDocumentPreview: "",
      fromDate: null,
      fromTime: "",
      untilDate: null,
      untilTime: "",
      vehicleConditionImages: [],
      vehicleConditionPreviews: [],
      accessories: {
        helmet: 0,
        lock: 0,
        elasticStraps: 0
      },
      otherAccessories: {
        bikeMirror: false,
        charger: false,
        babySeat: false,
        seatCushion: false,
        phoneMount: false,
        batteryKey: false,
        bikeBasket: false
      },
      termsAgreed: false,
      underagedPerson: "no",
      participantSignature: ""
    };
    
    // Signature pad initialization
    let signaturePad;
    
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize EmailJS
      // REPLACE WITH YOUR EMAILJS USER ID
      emailjs.init("YOUR_EMAILJS_USER_ID");
      
      // Initialize signature pad
      const canvas = document.getElementById('signatureCanvas');
      signaturePad = new SignaturePad(canvas, {
        backgroundColor: 'rgba(255, 255, 255, 0)',
        penColor: 'black'
      });
      
      // Add placeholder text to canvas
      addSignaturePlaceholder();
      
      // Initialize date pickers
      initDatePickers();
      
      // Initialize language selector
      initLanguageSelector();
      
      // Initialize country code selector
      initCountryCodeSelector();
      
      // Initialize form events
      initFormEvents();
      
      // Initialize accessories buttons
      initAccessoryButtons();
      
      // Handle form submission
      document.getElementById('rentalForm').addEventListener('submit', handleSubmit);
      
      // Handle window resize for signature canvas
      window.addEventListener('resize', function() {
        resizeCanvas();
      });
      resizeCanvas();
    });
    
    // Resize canvas when window size changes
    function resizeCanvas() {
      const canvas = document.getElementById('signatureCanvas');
      const ratio = Math.max(window.devicePixelRatio || 1, 1);
      canvas.width = canvas.offsetWidth * ratio;
      canvas.height = canvas.offsetHeight * ratio;
      canvas.getContext("2d").scale(ratio, ratio);
      signaturePad.clear(); // Otherwise isEmpty() might return incorrect value
      addSignaturePlaceholder();
    }
    
    // Function to handle language change
    function changeLanguage(language) {
      currentLanguage = language;
      
      // Update text elements
      document.getElementById('formTitle').textContent = translations[language].formTitle;
      document.getElementById('renterInfoTitle').textContent = translations[language].renterInfo;
      document.getElementById('rentalPeriodTitle').textContent = translations[language].rentalPeriod;
      document.getElementById('accessoriesTitle').textContent = translations[language].accessories;
      document.getElementById('termsTitle').textContent = translations[language].termsTitle;
      document.getElementById('vehicleConditionLabel').textContent = translations[language].vehicleCondition;
      
      // Update form field labels
      document.getElementById('firstNameLabel').textContent = translations[language].firstName;
      document.getElementById('middleNameLabel').textContent = translations[language].middleName;
      document.getElementById('lastNameLabel').textContent = translations[language].lastName;
      document.getElementById('nationalityLabel').textContent = translations[language].nationality;
      document.getElementById('emailLabel').textContent = translations[language].email;
      document.getElementById('phoneNumberLabel').textContent = translations[language].phoneNumber;
      document.getElementById('countryCodeText').textContent = translations[language].countryCode;
      document.getElementById('phoneNumberText').textContent = translations[language].phoneNumber;
      document.getElementById('vehicleTypeLabel').textContent = translations[language].vehicleType;
      document.getElementById('idDocumentLabel').textContent = translations[language].idDocument;
      
      // Update vehicle type options
      document.getElementById('eScooterLabel').textContent = translations[language].eScooter;
      document.getElementById('mountainEBikeLabel').textContent = translations[language].mountainEBike;
      document.getElementById('trekkingEBikeLabel').textContent = translations[language].trekkingEBike;
      document.getElementById('fatTireEBikeLabel').textContent = translations[language].fatTireEBike;
      
      // Update date and time labels
      document.getElementById('fromLabel').textContent = translations[language].from;
      document.getElementById('untilLabel').textContent = translations[language].until;
      document.getElementById('dateText').textContent = translations[language].date;
      document.getElementById('hourMinutesText').textContent = translations[language].hourMinutes;
      document.getElementById('selectTimeLabel').textContent = translations[language].selectTime;
      
      // Update date/time button text
      if (!formData.fromDate) document.getElementById('fromDateText').textContent = translations[language].selectDate;
      if (!formData.fromTime) document.getElementById('fromTimeText').textContent = translations[language].selectTime;
      if (!formData.untilDate) document.getElementById('untilDateText').textContent = translations[language].selectDate;
      if (!formData.untilTime) document.getElementById('untilTimeText').textContent = translations[language].selectTime;
      
      // Update upload texts
      document.getElementById('browseFilesText').textContent = translations[language].browseFiles;
      document.getElementById('dragAndDropText').textContent = translations[language].dragAndDrop;
      document.getElementById('browseFilesTextMultiple').textContent = translations[language].browseFiles;
      document.getElementById('dragAndDropTextMultiple').textContent = translations[language].dragAndDropMultiple;
      document.getElementById('addMoreImagesText').textContent = translations[language].addMoreImages;
      
      // Update accessories labels
      document.getElementById('helmetLabel').textContent = translations[language].helmet;
      document.getElementById('lockLabel').textContent = translations[language].lock;
      document.getElementById('elasticStrapsLabel').textContent = translations[language].elasticStraps;
      document.getElementById('otherAccessoriesLabel').textContent = translations[language].otherAccessories;
      document.getElementById('bikeMirrorLabel').textContent = translations[language].bikeMirror;
      document.getElementById('phoneMountLabel').textContent = translations[language].phoneMount;
      document.getElementById('chargerLabel').textContent = translations[language].charger;
      document.getElementById('batteryKeyLabel').textContent = translations[language].batteryKey;
      document.getElementById('babySeatLabel').textContent = translations[language].babySeat;
      document.getElementById('bikeBasketLabel').textContent = translations[language].bikeBasket;
      document.getElementById('seatCushionLabel').textContent = translations[language].seatCushion;
      
      // Update terms and conditions
      if (translations[language].termsText) {
        document.getElementById('termsText').innerHTML = translations[language].termsText;
      }
      document.getElementById('readAndAgreed').textContent = translations[language].readAndAgreed;
      document.getElementById('termsAndConditionsLink').textContent = translations[language].termsAndConditions;
      document.getElementById('underagedQuestionLabel').textContent = translations[language].underagedQuestion;
      document.getElementById('yesLabel').textContent = translations[language].yes;
      document.getElementById('noLabel').textContent = translations[language].no;
      
      // Update signature section
      document.getElementById('ownerSignatureLabel').textContent = translations[language].ownerSignature;
      document.getElementById('participantSignatureLabel').textContent = translations[language].participantSignature;
      document.getElementById('clearLabel').textContent = translations[language].clear;
      
      // Update submit button
      document.getElementById('submitLabel').textContent = translations[language].submit;
      
      // Update loading text
      document.getElementById('loadingText').textContent = translations[language].processingSubmission;
      
      // Update signature placeholder
      addSignaturePlaceholder();
    }
    
    // Add placeholder text to signature canvas
    function addSignaturePlaceholder() {
      if (signaturePad.isEmpty()) {
        const canvas = document.getElementById('signatureCanvas');
        const ctx = canvas.getContext('2d');
        ctx.font = '16px Arial';
        ctx.fillStyle = '#cccccc';
        ctx.textAlign = 'center';
        ctx.fillText(translations[currentLanguage].signHere || 'Sign Here', canvas.width / 2, canvas.height / 2);
      }
    }
    
    // Initialize language selector dropdown
    function initLanguageSelector() {
      const languageBtn = document.getElementById('languageBtn');
      const languageDropdown = document.getElementById('languageDropdown');
      
      languageBtn.addEventListener('click', function(e) {
        e.preventDefault();
        languageDropdown.classList.toggle('show');
      });
      
      // Close dropdown when clicking outside
      window.addEventListener('click', function(e) {
        if (!e.target.matches('#languageBtn') && !e.target.closest('#languageBtn')) {
          if (languageDropdown.classList.contains('show')) {
            languageDropdown.classList.remove('show');
          }
        }
      });
      
      // Handle language selection
      const languageItems = document.querySelectorAll('.dropdown-item[data-lang]');
      languageItems.forEach(item => {
        item.addEventListener('click', function() {
          const language = this.getAttribute('data-lang');
          document.getElementById('selectedLanguage').textContent = this.querySelector('span').textContent;
          
          // Remove check mark from all items
          languageItems.forEach(li => {
            const checkIcon = li.querySelector('svg');
            if (checkIcon) checkIcon.style.opacity = '0';
          });
          
          // Add check mark to selected item
          const checkIcon = this.querySelector('svg');
          if (checkIcon) checkIcon.style.opacity = '1';
          
          changeLanguage(language);
          languageDropdown.classList.remove('show');
        });
      });
    }
    
    // Initialize country code selector
    function initCountryCodeSelector() {
      const countryCodes = [
        { value: "+1", label: "üá∫üá∏ United States (+1)" },
        { value: "+44", label: "üá¨üáß United Kingdom (+44)" },
        { value: "+49", label: "üá©üá™ Germany (+49)" },
        { value: "+33", label: "üá´üá∑ France (+33)" },
        { value: "+39", label: "üáÆüáπ Italy (+39)" },
        { value: "+34", label: "üá™üá∏ Spain (+34)" },
        { value: "+31", label: "üá≥üá± Netherlands (+31)" },
        { value: "+30", label: "üá¨üá∑ Greece (+30)" },
        { value: "+86", label: "üá®üá≥ China (+86)" },
        { value: "+91", label: "üáÆüá≥ India (+91)" },
        { value: "+81", label: "üáØüáµ Japan (+81)" },
        { value: "+82", label: "üá∞üá∑ South Korea (+82)" },
        { value: "+61", label: "üá¶üá∫ Australia (+61)" },
        { value: "+64", label: "üá≥üáø New Zealand (+64)" },
        { value: "+52", label: "üá≤üáΩ Mexico (+52)" },
        { value: "+55", label: "üáßüá∑ Brazil (+55)" },
        { value: "+7", label: "üá∑üá∫ Russia (+7)" },
        { value: "+27", label: "üáøüá¶ South Africa (+27)" },
        { value: "+20", label: "üá™üá¨ Egypt (+20)" },
        { value: "+971", label: "üá¶üá™ United Arab Emirates (+971)" },
        { value: "+966", label: "üá∏üá¶ Saudi Arabia (+966)" },
        { value: "+65", label: "üá∏üá¨ Singapore (+65)" },
        { value: "+60", label: "üá≤üáæ Malaysia (+60)" },
        { value: "+66", label: "üáπüá≠ Thailand (+66)" },
        { value: "+84", label: "üáªüá≥ Vietnam (+84)" },
        { value: "+62", label: "üáÆüá© Indonesia (+62)" },
        { value: "+63", label: "üáµüá≠ Philippines (+63)" },
        { value: "+90", label: "üáπüá∑ Turkey (+90)" },
        { value: "+48", label: "üáµüá± Poland (+48)" },
        { value: "+46", label: "üá∏üá™ Sweden (+46)" }
      ];
      
      // Populate country code list
      const countryCodeList = document.getElementById('countryCodeList');
      countryCodes.forEach(country => {
        const item = document.createElement('div');
        item.className = 'dropdown-item';
        item.setAttribute('data-value', country.value);
        item.textContent = country.label;
        countryCodeList.appendChild(item);
        
        item.addEventListener('click', function() {
          const value = this.getAttribute('data-value');
          document.getElementById('selectedCountryCode').textContent = value;
          formData.countryCode = value;
          document.getElementById('countryCodeDropdown').classList.remove('show');
        });
      });
      
      // Handle dropdown toggling
      document.getElementById('countryCodeBtn').addEventListener('click', function(e) {
        e.preventDefault();
        document.getElementById('countryCodeDropdown').classList.toggle('show');
      });
      
      // Handle search functionality
      document.getElementById('countryCodeSearch').addEventListener('input', function() {
        const searchText = this.value.toLowerCase();
        const items = countryCodeList.getElementsByClassName('dropdown-item');
        
        for (let i = 0; i < items.length; i++) {
          const item = items[i];
          const text = item.textContent.toLowerCase();
          
          if (text.includes(searchText)) {
            item.style.display = '';
          } else {
            item.style.display = 'none';
          }
        }
      });
    }
    
    // Initialize date pickers
    function initDatePickers() {
      // From date picker
      const fromDatePicker = new Pikaday({
        field: document.getElementById('fromDateBtn'),
        trigger: document.getElementById('fromDateBtn'),
        container: document.getElementById('fromDatePicker'),
        format: 'MMM D, YYYY',
        onSelect: function(date) {
          formData.fromDate = date;
          document.getElementById('fromDateText').textContent = this.toString();
          document.getElementById('fromDateError').classList.add('hidden');
        }
      });
      
      // Until date picker
      const untilDatePicker = new Pikaday({
        field: document.getElementById('untilDateBtn'),
        trigger: document.getElementById('untilDateBtn'),
        container: document.getElementById('untilDatePicker'),
        format: 'MMM D, YYYY',
        onSelect: function(date) {
          formData.untilDate = date;
          document.getElementById('untilDateText').textContent = this.toString();
          document.getElementById('untilDateError').classList.add('hidden');
        }
      });
      
      // Handle from time picker
      document.getElementById('fromTimeBtn').addEventListener('click', function() {
        const picker = document.getElementById('fromTimePicker');
        picker.classList.toggle('hidden');
      });
      
      // Handle until time picker
      document.getElementById('untilTimeBtn').addEventListener('click', function() {
        const picker = document.getElementById('untilTimePicker');
        picker.classList.toggle('hidden');
      });
      
      // Handle time selection for "from" time
      ['fromTimeHour', 'fromTimeMinute', 'fromTimePeriod'].forEach(id => {
        document.getElementById(id).addEventListener('change', updateFromTime);
      });
      
      // Handle time selection for "until" time
      ['untilTimeHour', 'untilTimeMinute', 'untilTimePeriod'].forEach(id => {
        document.getElementById(id).addEventListener('change', updateUntilTime);
      });
    }
    
    // Update "from" time when selection changes
    function updateFromTime() {
      const hour = document.getElementById('fromTimeHour').value;
      const minute = document.getElementById('fromTimeMinute').value;
      const period = document.getElementById('fromTimePeriod').value;
      
      const timeString = `${hour}:${minute} ${period}`;
      formData.fromTime = timeString;
      document.getElementById('fromTimeText').textContent = timeString;
      document.getElementById('fromTimeError').classList.add('hidden');
    }
    
    // Update "until" time when selection changes
    function updateUntilTime() {
      const hour = document.getElementById('untilTimeHour').value;
      const minute = document.getElementById('untilTimeMinute').value;
      const period = document.getElementById('untilTimePeriod').value;
      
      const timeString = `${hour}:${minute} ${period}`;
      formData.untilTime = timeString;
      document.getElementById('untilTimeText').textContent = timeString;
      document.getElementById('untilTimeError').classList.add('hidden');
    }
    
    // Initialize form events
    function initFormEvents() {
      // Handle text input changes
      const textInputs = ['firstName', 'middleName', 'lastName', 'nationality', 'email', 'phoneNumber'];
      textInputs.forEach(id => {
        const input = document.getElementById(id);
        input.addEventListener('input', function() {
          formData[id] = this.value;
          const errorEl = document.getElementById(`${id}Error`);
          if (errorEl) errorEl.classList.add('hidden');
        });
      });
      
      // Handle vehicle type selection
      const vehicleTypeInputs = document.querySelectorAll('input[name="vehicleType"]');
      vehicleTypeInputs.forEach(input => {
        input.addEventListener('change', function() {
          formData.vehicleType = this.value;
          document.getElementById('vehicleTypeError').classList.add('hidden');
        });
      });
      
      // Handle ID document upload
      document.getElementById('idDocument').addEventListener('change', function(e) {
        if (e.target.files && e.target.files[0]) {
          const file = e.target.files[0];
          formData.idDocument = file;
          
          const reader = new FileReader();
          reader.onload = function(e) {
            formData.idDocumentPreview = e.target.result;
            document.getElementById('idDocumentImage').src = e.target.result;
            document.getElementById('idDocumentPreview').classList.remove('hidden');
            document.getElementById('idDocumentPlaceholder').classList.add('hidden');
            document.getElementById('idDocumentError').classList.add('hidden');
          };
          reader.readAsDataURL(file);
        }
      });
      
      // Handle vehicle condition images upload
      document.getElementById('vehicleCondition').addEventListener('change', function(e) {
        if (e.target.files && e.target.files.length > 0) {
          const newFiles = Array.from(e.target.files);
          
          newFiles.forEach(file => {
            formData.vehicleConditionImages.push(file);
            
            const reader = new FileReader();
            reader.onload = function(e) {
              formData.vehicleConditionPreviews.push(e.target.result);
              updateVehicleConditionPreviews();
            };
            reader.readAsDataURL(file);
          });
          
          document.getElementById('vehicleConditionError').classList.add('hidden');
        }
      });
      
      // Handle terms agreement
      document.getElementById('termsAgreed').addEventListener('change', function() {
        formData.termsAgreed = this.checked;
        document.getElementById('termsAgreedError').classList.add('hidden');
      });
      
      // Handle underaged person selection
      const underagedInputs = document.querySelectorAll('input[name="underagedPerson"]');
      underagedInputs.forEach(input => {
        input.addEventListener('change', function() {
          formData.underagedPerson = this.value;
        });
      });
      
      // Handle other accessories checkboxes
      const accessoryCheckboxes = ['bikeMirror', 'phoneMount', 'charger', 'batteryKey', 'babySeat', 'bikeBasket', 'seatCushion'];
      accessoryCheckboxes.forEach(id => {
        document.getElementById(id).addEventListener('change', function() {
          formData.otherAccessories[id] = this.checked;
        });
      });
      
      // Handle signature clear button
      document.getElementById('clearSignatureBtn').addEventListener('click', function() {
        signaturePad.clear();
        formData.participantSignature = '';
        addSignaturePlaceholder();
      });
      
      // Handle signature changes
      document.getElementById('signatureCanvas').addEventListener('mouseup', saveSignature);
      document.getElementById('signatureCanvas').addEventListener('touchend', saveSignature);
    }
    
    // Initialize accessory buttons
    function initAccessoryButtons() {
      const accessoryButtons = document.querySelectorAll('.accessory-btn');
      
      accessoryButtons.forEach(button => {
        button.addEventListener('click', function() {
          const type = this.getAttribute('data-type');
          const value = parseInt(this.getAttribute('data-value'));
          
          // Update formData
          formData.accessories[type] = value;
          
          // Update UI - remove selected class from all buttons of this type
          document.querySelectorAll(`.accessory-btn[data-type="${type}"]`).forEach(btn => {
            btn.classList.remove('selected');
          });
          
          // Add selected class to clicked button
          this.classList.add('selected');
        });
      });
    }
    
    // Update vehicle condition previews
    function updateVehicleConditionPreviews() {
      const previewContainer = document.getElementById('vehicleConditionPreview');
      previewContainer.innerHTML = '';
      
      formData.vehicleConditionPreviews.forEach((preview, index) => {
        const previewEl = document.createElement('div');
        previewEl.className = 'preview-image';
        
        const img = document.createElement('img');
        img.src = preview;
        img.alt = `Vehicle condition ${index + 1}`;
        
        const removeBtn = document.createElement('button');
        removeBtn.className = 'remove-btn';
        removeBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>';
        removeBtn.onclick = function(e) {
          e.stopPropagation();
          removeVehicleConditionImage(index);
        };
        
        previewEl.appendChild(img);
        previewEl.appendChild(removeBtn);
        previewContainer.appendChild(previewEl);
      });
      
      // Show or hide placeholders based on whether there are images
      if (formData.vehicleConditionPreviews.length > 0) {
        document.getElementById('vehicleConditionPreviewContainer').classList.remove('hidden');
        document.getElementById('vehicleConditionPlaceholder').classList.add('hidden');
      } else {
        document.getElementById('vehicleConditionPreviewContainer').classList.add('hidden');
        document.getElementById('vehicleConditionPlaceholder').classList.remove('hidden');
      }
    }
    
    // Remove vehicle condition image
    function removeVehicleConditionImage(index) {
      formData.vehicleConditionImages.splice(index, 1);
      formData.vehicleConditionPreviews.splice(index, 1);
      updateVehicleConditionPreviews();
      
      if (formData.vehicleConditionImages.length === 0) {
        document.getElementById('vehicleConditionError').classList.remove('hidden');
      }
    }
    
    // Clear ID document
    function clearIdDocument() {
      formData.idDocument = null;
      formData.idDocumentPreview = '';
      document.getElementById('idDocumentPreview').classList.add('hidden');
      document.getElementById('idDocumentPlaceholder').classList.remove('hidden');
      document.getElementById('idDocumentError').classList.remove('hidden');
    }
    
    // Save signature data
    function saveSignature() {
      if (!signaturePad.isEmpty()) {
        formData.participantSignature = signaturePad.toDataURL();
        document.getElementById('participantSignatureError').classList.add('hidden');
      }
    }
    
    // Validate form
    function validateForm() {
      let isValid = true;
      
      // Required fields validation
      if (!formData.firstName) {
        document.getElementById('firstNameError').textContent = `${translations[currentLanguage].firstName} ${translations[currentLanguage].required}`;
        document.getElementById('firstNameError').classList.remove('hidden');
        isValid = false;
      }
      
      if (!formData.lastName) {
        document.getElementById('lastNameError').textContent = `${translations[currentLanguage].lastName} ${translations[currentLanguage].required}`;
        document.getElementById('lastNameError').classList.remove('hidden');
        isValid = false;
      }
      
      if (!formData.nationality) {
        document.getElementById('nationalityError').textContent = `${translations[currentLanguage].nationality} ${translations[currentLanguage].required}`;
        document.getElementById('nationalityError').classList.remove('hidden');
        isValid = false;
      }
      
      if (!formData.email) {
        document.getElementById('emailError').textContent = `${translations[currentLanguage].email} ${translations[currentLanguage].required}`;
        document.getElementById('emailError').classList.remove('hidden');
        isValid = false;
      }
      
      if (!formData.phoneNumber) {
        document.getElementById('phoneNumberError').textContent = `${translations[currentLanguage].phoneNumber} ${translations[currentLanguage].required}`;
        document.getElementById('phoneNumberError').classList.remove('hidden');
        isValid = false;
      }
      
      // Vehicle type validation
      if (!formData.vehicleType) {
        document.getElementById('vehicleTypeError').textContent = translations[currentLanguage].selectVehicleType;
        document.getElementById('vehicleTypeError').classList.remove('hidden');
        isValid = false;
      }
      
      // ID document validation
      if (!formData.idDocument) {
        document.getElementById('idDocumentError').textContent = translations[currentLanguage].uploadId;
        document.getElementById('idDocumentError').classList.remove('hidden');
        isValid = false;
      }
      
      // Date and time validation
      if (!formData.fromDate) {
        document.getElementById('fromDateError').textContent = `${translations[currentLanguage].from} ${translations[currentLanguage].date} ${translations[currentLanguage].required}`;
        document.getElementById('fromDateError').classList.remove('hidden');
        isValid = false;
      }
      
      if (!formData.fromTime) {
        document.getElementById('fromTimeError').textContent = `${translations[currentLanguage].from} ${translations[currentLanguage].hourMinutes} ${translations[currentLanguage].required}`;
        document.getElementById('fromTimeError').classList.remove('hidden');
        isValid = false;
      }
      
      if (!formData.untilDate) {
        document.getElementById('untilDateError').textContent = `${translations[currentLanguage].until} ${translations[currentLanguage].date} ${translations[currentLanguage].required}`;
        document.getElementById('untilDateError').classList.remove('hidden');
        isValid = false;
      }
      
      if (!formData.untilTime) {
        document.getElementById('untilTimeError').textContent = `${translations[currentLanguage].until} ${translations[currentLanguage].hourMinutes} ${translations[currentLanguage].required}`;
        document.getElementById('untilTimeError').classList.remove('hidden');
        isValid = false;
      }
      
      // Vehicle condition images validation
      if (formData.vehicleConditionImages.length === 0) {
        document.getElementById('vehicleConditionError').textContent = translations[currentLanguage].uploadVehicleImages;
        document.getElementById('vehicleConditionError').classList.remove('hidden');
        isValid = false;
      }
      
      // Terms agreement validation
      if (!formData.termsAgreed) {
        document.getElementById('termsAgreedError').textContent = translations[currentLanguage].agreeToTerms;
        document.getElementById('termsAgreedError').classList.remove('hidden');
        isValid = false;
      }
      
      // Signature validation
      if (signaturePad.isEmpty()) {
        document.getElementById('participantSignatureError').textContent = translations[currentLanguage].signatureRequired;
        document.getElementById('participantSignatureError').classList.remove('hidden');
        isValid = false;
      }
      
      return isValid;
    }
    
    // Generate PDF from form data
    function generatePDF() {
      return new Promise((resolve, reject) => {
        try {
          // Initialize jsPDF
          const { jsPDF } = window.jspdf;
          const doc = new jsPDF();
          
          // Add title
          doc.setFontSize(20);
          doc.text("SeeMe Rolling E-Bike Rental Agreement", 105, 15, { align: "center" });
          
          // Add logo
          if (document.querySelector('img[src="logo.png"]')) {
            try {
              const logoImg = document.querySelector('img[src="logo.png"]');
              const canvas = document.createElement('canvas');
              canvas.width = logoImg.width;
              canvas.height = logoImg.height;
              const ctx = canvas.getContext('2d');
              ctx.drawImage(logoImg, 0, 0, logoImg.width, logoImg.height);
              const logoData = canvas.toDataURL('image/png');
              doc.addImage(logoData, 'PNG', 85, 20, 40, 40);
            } catch (e) {
              console.error("Error adding logo to PDF:", e);
            }
          }
          
          // Add renter information
          doc.setFontSize(16);
          doc.text("Renter Information", 14, 70);
          
          doc.setFontSize(12);
          doc.text(
            `Name: ${formData.firstName} ${formData.middleName ? formData.middleName + " " : ""}${formData.lastName}`,
            14, 80
          );
          doc.text(`Nationality: ${formData.nationality}`, 14, 90);
          doc.text(`Email: ${formData.email}`, 14, 100);
          doc.text(`Phone: ${formData.countryCode} ${formData.phoneNumber}`, 14, 110);
          doc.text(`Vehicle Type: ${formData.vehicleType}`, 14, 120);
          
          // Add rental period
          doc.setFontSize(16);
          doc.text("Rental Period", 14, 140);
          
          doc.setFontSize(12);
          const fromDate = formData.fromDate ? formData.fromDate.toLocaleDateString() : "N/A";
          const untilDate = formData.untilDate ? formData.untilDate.toLocaleDateString() : "N/A";
          
          doc.text(`From: ${fromDate} ${formData.fromTime}`, 14, 150);
          doc.text(`Until: ${untilDate} ${formData.untilTime}`, 14, 160);
          
          // Add accessories
          doc.setFontSize(16);
          doc.text("Accessories", 14, 180);
          
          doc.setFontSize(12);
          doc.text(`Helmet: ${formData.accessories.helmet}`, 14, 190);
          doc.text(`Lock: ${formData.accessories.lock}`, 14, 200);
          doc.text(`Elastic Straps: ${formData.accessories.elasticStraps}`, 14, 210);
          
          // Add other accessories
          let otherAccessoriesText = "Other Accessories: ";
          const selectedAccessories = [];
          
          if (formData.otherAccessories.bikeMirror) selectedAccessories.push("Bike Mirror");
          if (formData.otherAccessories.charger) selectedAccessories.push("Charger");
          if (formData.otherAccessories.babySeat) selectedAccessories.push("Baby Seat");
          if (formData.otherAccessories.seatCushion) selectedAccessories.push("Seat Cushion");
          if (formData.otherAccessories.phoneMount) selectedAccessories.push("Phone Mount");
          if (formData.otherAccessories.batteryKey) selectedAccessories.push("Battery Key");
          if (formData.otherAccessories.bikeBasket) selectedAccessories.push("Bike Basket");
          
          otherAccessoriesText += selectedAccessories.join(", ") || "None";
          
          doc.text(otherAccessoriesText, 14, 220);
          
          // Add underaged person information
          doc.text(`Underaged Person Participating: ${formData.underagedPerson === "yes" ? "Yes" : "No"}`, 14, 230);
          
          // Add terms and conditions acknowledgment
          doc.setFontSize(16);
          doc.text("Terms and Conditions", 14, 240);
          
          doc.setFontSize(12);
          doc.text(`I have read and agreed to the terms & conditions: ${formData.termsAgreed ? "Yes" : "No"}`, 14, 250);
          
          // Add signatures
          doc.setFontSize(16);
          doc.text("Signatures", 14, 260);
          
          // Add owner signature
          doc.setFontSize(12);
          doc.text("Owner Signature:", 14, 270);
          
          if (document.querySelector('img[src="owner-signature.png"]')) {
            try {
              const ownerSignatureImg = document.querySelector('img[src="owner-signature.png"]');
              const canvas = document.createElement('canvas');
              canvas.width = ownerSignatureImg.width;
              canvas.height = ownerSignatureImg.height;
              const ctx = canvas.getContext('2d');
              ctx.drawImage(ownerSignatureImg, 0, 0, ownerSignatureImg.width, ownerSignatureImg.height);
              const ownerSignatureData = canvas.toDataURL('image/png');
              doc.addImage(ownerSignatureData, 'PNG', 70, 260, 60, 20);
            } catch (e) {
              console.error("Error adding owner signature to PDF:", e);
            }
          }
          
          // Add participant signature
          doc.text("Participant Signature:", 14, 290);
          
          if (formData.participantSignature) {
            try {
              doc.addImage(formData.participantSignature, 'PNG', 70, 280, 60, 20);
            } catch (e) {
              console.error("Error adding participant signature to PDF:", e);
            }
          }
          
          // Convert to blob
          const pdfBlob = doc.output('blob');
          resolve(pdfBlob);
        } catch (error) {
          console.error("Error generating PDF:", error);
          reject(error);
        }
      });
    }
    
    // Send email with PDF attachment
    async function sendEmailWithPDF(pdfBlob) {
      return new Promise((resolve, reject) => {
        try {
          // Create a File object from the Blob
          const pdfFile = new File([pdfBlob], "rental-agreement.pdf", { type: "application/pdf" });
          
          // Create a FormData object to send the file
          const formDataToSend = new FormData();
          formDataToSend.append("pdf", pdfFile);
          
          // Prepare email data
          const emailData = {
            to_email: formData.email,
            to_name: `${formData.firstName} ${formData.lastName}`,
            from_name: "SeeMe Rolling E-Bike Rentals",
            subject: "Your E-Bike Rental Agreement",
            message: `Dear ${formData.firstName},\n\nThank you for renting with SeeMe Rolling E-Bike Rentals. Attached is a copy of your rental agreement.\n\nRental Period: ${formData.fromDate ? formData.fromDate.toLocaleDateString() : "N/A"} ${formData.fromTime} to ${formData.untilDate ? formData.untilDate.toLocaleDateString() : "N/A"} ${formData.untilTime}\n\nVehicle Type: ${formData.vehicleType}\n\nWe hope you enjoy your ride!\n\nBest regards,\nSeeMe Rolling E-Bike Rentals Team`,
            pdf_url: URL.createObjectURL(pdfBlob)
          };
          
          // Send email using EmailJS
          // REPLACE WITH YOUR EMAILJS SERVICE ID AND TEMPLATE ID
          emailjs.send("YOUR_EMAILJS_SERVICE_ID", "YOUR_EMAILJS_TEMPLATE_ID", emailData)
            .then(function(response) {
              console.log("Email sent successfully:", response);
              resolve(response);
            }, function(error) {
              console.error("Email sending failed:", error);
              reject(error);
            });
        } catch (error) {
          console.error("Error preparing email:", error);
          reject(error);
        }
      });
    }
    
    // Upload PDF to Google Drive
    async function uploadPDFToGoogleDrive(pdfBlob) {
      return new Promise((resolve, reject) => {
        try {
          // Load the Google API client
          gapi.load('client:auth2', async () => {
            try {
              // Initialize the Google API client
              // REPLACE WITH YOUR GOOGLE API CLIENT ID
              await gapi.client.init({
                apiKey: 'YOUR_GOOGLE_API_KEY',
                clientId: 'YOUR_GOOGLE_CLIENT_ID',
                discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],
                scope: 'https://www.googleapis.com/auth/drive.file'
              });
              
              // Sign in the user
              if (!gapi.auth2.getAuthInstance().isSignedIn.get()) {
                await gapi.auth2.getAuthInstance().signIn();
              }
              
              // Create a file metadata
              const metadata = {
                name: `Rental Agreement - ${formData.firstName} ${formData.lastName} - ${new Date().toISOString().split('T')[0]}.pdf`,
                mimeType: 'application/pdf',
                // REPLACE WITH YOUR GOOGLE DRIVE FOLDER ID WHERE YOU WANT TO SAVE THE FILES
                parents: ['YOUR_GOOGLE_DRIVE_FOLDER_ID']
              };
              
              // Create a FormData object to send the file
              const formDataToSend = new FormData();
              formDataToSend.append('metadata', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));
              formDataToSend.append('file', pdfBlob);
              
              // Upload the file to Google Drive
              const accessToken = gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token;
              const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                method: 'POST',
                headers: {
                  Authorization: `Bearer ${accessToken}`
                },
                body: formDataToSend
              });
              
              if (response.ok) {
                const result = await response.json();
                console.log("File uploaded to Google Drive:", result);
                resolve(result);
              } else {
                const error = await response.text();
                console.error("Error uploading file to Google Drive:", error);
                reject(new Error(error));
              }
            } catch (error) {
              console.error("Error with Google Drive API:", error);
              reject(error);
            }
          });
        } catch (error) {
          console.error("Error loading Google API client:", error);
          reject(error);
        }
      });
    }
    
    // Handle form submission
    async function handleSubmit(e) {
      e.preventDefault();
      
      if (validateForm()) {
        // Show loading overlay
        document.getElementById('loadingOverlay').style.display = 'flex';
        document.getElementById('loadingText').textContent = translations[currentLanguage].processingSubmission;
        
        try {
          // Generate PDF
          const pdfBlob = await generatePDF();
          
          // Send email with PDF attachment
          document.getElementById('loadingText').textContent = translations[currentLanguage].emailSent;
          await sendEmailWithPDF(pdfBlob);
          
          // Upload PDF to Google Drive
          document.getElementById('loadingText').textContent = translations[currentLanguage].uploadingToDrive;
          await uploadPDFToGoogleDrive(pdfBlob);
          
          document.getElementById('loadingText').textContent = translations[currentLanguage].uploadComplete;
          
          // Hide loading overlay
          setTimeout(() => {
            document.getElementById('loadingOverlay').style.display = 'none';
            
            // Show success message
            alert(translations[currentLanguage].submissionSuccess);
            
            // For a real implementation, you might reset the form or redirect
            // document.getElementById('rentalForm').reset();
            // window.location.href = '/thank-you';
          }, 1000);
        } catch (error) {
          console.error("Error processing form submission:", error);
          document.getElementById('loadingOverlay').style.display = 'none';
          alert("There was an error submitting the form. Please try again.");
        }
      } else {
        // Scroll to the first error
        const firstError = document.querySelector('.text-red-500:not(.hidden)');
        if (firstError) {
          firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
      }
    }
  </script>
</body>
</html>
